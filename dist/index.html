<html><head><title>üèù</title><meta content="width=device-width,initial-scale=1" name=viewport><style>*{user-select:none}body,html{margin:0;padding:0}#M,body{align-items:center;display:flex;justify-content:center;height:100%;text-shadow:0 0 8px #000,-1px -1px 3px #000,1px 1px 3px #000;background:#000;color:#fca;text-align:center;font-family:Papyrus,Gabriola,'Times New Roman',Times,serif}#M{position:relative;letter-spacing:.01em}input{width:1.2rem;height:1.2rem;vertical-align:middle}#V{width:15em}#N,#T{position:absolute}#N{top:0;display:none;width:100%;height:100%;backdrop-filter:blur(15px) contrast(200%) brightness(35%)}b{cursor:pointer}b:hover{text-decoration:underline}.X{opacity:.5;cursor:no-drop}.X:hover{text-decoration:none}#T{padding:2px;bottom:0}h1,h3{margin:.2em}small{display:block;margin:.55em}label{margin:.4em}@-moz-document url-prefix(){.N #C{filter:blur(15px) contrast(190%) brightness(50%)}}.N #T{display:none}.N #N{display:block}a,a:active,a:visited{opacity:.7;font-size:.6em;color:#fca}a:hover{opacity:1}</style></head><body class=L><div id=M><canvas id=C></canvas><div id=T><h1>Loading...</h1></div><div id=N><h1>ISLAND NOT FOUND</h1><h3><b id=R>New Game</b></h3><h3><b id=S class=X>Save Game</b></h3><h3><b id=L>Load Game</b></h3><small><label><input id=Y type=checkbox> Invert Y</label><label><input id=Q type=checkbox checked> High quality</label><label><input id=H type=checkbox checked> Head Bob</label><br><label>Mouse sensitivity <input id=V type=range value=50></label><br><br>Shift: run<br>W,A,S,D/Z,Q,S,D/Arrows: move<br>Mouse: look around<br>E,Space: interact<br>Esc,M: menu</small><a href=https://github.com/SalvatorePreviti/js13k-2020 target=_blank>Copyright (c) 2020 Ben Clark, Salvatore Previti.</a></div></div><script>(({document:e,requestAnimationFrame:t,Uint8Array:c})=>{(()=>{function a(e,t){for(const c in t)"object"==typeof t[c]?a(e[c],t[c]):e[c]=t[c]}const{abs:o,cos:i,floor:n,max:l,min:r,sin:f,sqrt:v,PI:m}=Math,x=2*m,s=m/180,b=(e,t)=>e+t,u=(e,t)=>e-t,h=(e,t)=>e*t,d=(e,t)=>e/t,{assign:y,values:g}=Object,z=[],w={},p={w:1,W:1,z:1,Z:1,ArrowUp:1,s:2,S:2,ArrowDown:2,a:3,A:3,q:3,Q:3,ArrowLeft:3,d:4,D:4,ArrowRight:4,Shift:5,e:6,E:6," ":6,Escape:8,M:8,m:8},C=(t,c)=>{if(!t.keyCode||t.metaKey||!e.activeElement||re)z.length=0;else{const e=0|p[t.key];c&&w[e]&&w[e](t.repeat),z[e]=c}};onkeydown=e=>C(e,!0),onkeyup=e=>C(e,!1);const k=(x,y,z)=>({x,y,z}),j=(e=0)=>({x:e,y:e,z:e}),S=j(),_=j(),A=k(0,1,0),D=(e,t,c,a)=>(e.x=t,e.y=c,e.z=a,e),F=(e,{x,y,z},o,i)=>D(e,i(x,o.x),i(y,o.y),i(z,o.z)),P=(e,{x,y,z},o,i)=>D(e,i(x,o),i(y,o),i(z,o)),N=({x,y,z},a)=>x*a.x+y*a.y+z*a.z,R=e=>v((({x,y,z})=>x**2+y**2+z**2)(e)),M=(e,t,c=e)=>F(e,t,c,b),H=(e,t,c=e)=>P(e,c,t,h),B=(e,t=e)=>((e,t,c)=>P(e,t,c,d))(e,t,R(t));let I=0,T=0,W=0,q=.033;const E={},L=g(E);let O=!1;const U={t:"",o:-1};let V=U;const G=[],J=(e,t=-1)=>{const c=e||t>0?{t:e,o:t}:U;G[0]?0>t?G[0]=c:G.splice(1,0,c):(G.unshift(c),t>0&&G.unshift(U))},Q={i:!1,l:{}},X=g(Q.l),K=k(103,44,9);let Y=0;const Z={x:-102*s,y:23*s},$=j(),ee=new Float32Array(9),te=e=>M(S,H(B(D(_,$.x,0,$.z)),e)),ce=e=>M(S,H(B(((e,{x,y,z},{x:o,y:i,z:n})=>D(e,y*n-z*i,z*o-x*n,x*i-y*o))(_,$,A)),e)),ae=()=>{let{x:e,y:t}=Z;O&&(e+=.005*f(100*I),t+=.005*f(200*I));const c=f(e),a=i(e),o=f(t),n=i(t);B(D($,c*n,-o,a*n)),((e,...t)=>{e.set(t)})(ee,a,0,-c,c*o,n,a*o,c*n,-o,a*n)};let oe=0;ae(),onmousemove=t=>{var a,c;e.pointerLockElement!==ne||Q.i||(Z.x=(a=Z.x-.001*t.movementX)-x*n((a+m)/x),Z.y=(c=87*s,r(l(Z.y+t.movementY*me*.001,-87*s),c)))};const ie=e.body,ne=e.getElementById("C"),le=e.getElementById("T");let re,fe,ve,me=1,xe=!0;const se=e.getElementById("M"),be=e.getElementById("R"),ue=e.getElementById("Q"),he=e.getElementById("Y"),de=e.getElementById("V"),ye=e.getElementById("H"),ge=e.getElementById("S"),ze=e.getElementById("L"),we=()=>{let e=r(1200,innerWidth-30),t=innerHeight-30;e/t>1.5?e=1.5*t:t=e/1.5;const c={width:0|e,height:0|t,fontSize:(0|t/23)+"px"};y(se.style,c),y(ne.style,c);let{clientWidth:a,clientHeight:o}=se;ue.checked||(a=0|a/2,o=0|o/2),fe=a,ve=o,ne.width=a,ne.height=o},pe=()=>{re=!0,ie.className="N",e.exitPointerLock()};e.onpointerlockchange=()=>{e.pointerLockElement||pe()};const Ce=e=>(!e||!e.button)&&!re&&ne.requestPointerLock();let ke;const je=(e=!0)=>{var c,t;ke||(ge.className="",e&&J("Where am I? How did I get here?",2),be.innerText="Resume Game",D(K,-44,4,11),c=0*s,(t=Z).x=70*s,t.y=c,ke=!0),re=!1,ie.className="",Ce()};we(),onresize=we,be.onclick=()=>je(),w[8]=pe,ne.onmousedown=Ce,ue.onchange=we,he.onchange=()=>{me=he.checked?-1:1},ye.onchange=()=>{xe=ye.checked},de.onchange=()=>{};const Se=ne.getContext("webgl2",{alpha:!1,desynchronized:!0,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,powerPreference:"high-performance",preserveDrawingBuffer:!1,stencil:!1}),_e=Se.createFramebuffer(),Ae=(e=10497,t=9729,c=t)=>{Se.texParameteri(3553,10242,e),Se.texParameteri(3553,10243,e),Se.texParameteri(3553,10241,t),Se.texParameteri(3553,10240,c)},De=e=>{const t=Se.createProgram(),c=(e,c)=>{const a=Se.createShader(e);return Se.shaderSource(a,c),Se.compileShader(a),Se.attachShader(t,a),a};c(35633,"#version 300 es\nprecision mediump int;uniform vec2 iR;out vec2 FC;void main(){vec2 a=vec2(float((gl_VertexID&1)<<2),float((gl_VertexID&2)<<1));gl_Position=vec4(a-1.,0.,1.);FC=a*iR*.5;}"),c(35632,"#version 300 es\nprecision highp float;in vec2 FC;uniform vec2 iR;uniform vec3 iP;uniform vec4 iD;uniform vec4 iA;uniform vec4 iB;uniform vec4 iC;uniform vec4 iS;uniform vec4 iX;uniform mat3 iM;uniform lowp int iF;out vec4 oC;uniform highp sampler2D tN;uniform highp sampler2D tH;uniform highp sampler2D tP;float a;float b(float a){return clamp(a,0.,1.);}float c(float a,float b,float c){float d=max(c-abs(a-b),0.)/c;return min(a,b)-d*d*c/4.;}vec4 d(float a){vec4 c=b(a)*vec4(.999998,254.99948,65024.867,160581056);c=fract(c);c-=c.yzww*vec4(.003921569,.003921569,.003921569,0);return c;}float e(vec4 a){return dot(a,vec4(1,.003921569,1.53787e-5,6.2273724e-9));}vec3 f(vec2 a){vec4 b=texelFetch(tN,ivec2(floor(a))&511,0);float c=b.y-b.x,d=b.z-b.x,e=b.w-c-b.z;vec2 f=fract(a),g=f*f,h=g*(3.-2.*f);return vec3(b.x+c*h.x+d*h.y+e*h.x*h.y,30.*g*(f*(f-2.)+1.)*(vec2(c,d)+e*h.yx));}int g=0;float h=150.;void i(int b,float c){if(c<a&&c!=h){g=b;h=c;}}float j(vec3 a,vec3 b){vec3 c=abs(a)-b;return min(max(c.x,max(c.y,c.z)),0.)+length(max(c,0.));}mat2 k(float a){float b=cos(a),c=sin(a);return mat2(b,c,-c,b);}float l(vec3 a){vec3 b=abs(vec3(a.x,a.y+3.,a.z))-vec3(60,0,39);if(b.x<0.&&b.z<0.){float c=e(textureLod(tH,a.xz/vec2(120,78)+.5,0.)),d=1.-c;b.y-=c*19.+d*d*d;}return min(b.y,0.)+length(max(b,0.));}float m(vec3 a){float b=j(a-vec3(-1.5,1,5)-vec3(-46,-.5,-30),vec3(1,.2,3));i(0,b);return b;}int n=0;float o(vec3 b){float c=l(b);if(c>a){float a=m(b);if(c>=a){n=2;return a;}}n=1;return c;}vec3 p(vec3 a){return normalize(vec3(m(a+vec3(.001,0,0)),m(a+vec3(0,.001,0)),m(a+vec3(0,0,.001)))-m(a));}vec3 q(vec3 a,float b){vec2 c=vec2(mix(.03,.001,min(b/120.,1.)),0);return normalize(vec3(l(a+c.xyy),l(a+c.yxy),l(a+c.yyx))-l(a));}float r(vec3 b,vec3 c,float d,float e){float f=d;for(int g=0;;g++){vec3 h=b+c*e;a=d*max(e,1.);if(h.y<=-2.9995||e>=150.){float a=(-3.-b.y)/c.y;if(a>=0.&&a<500.){n=1;return a;}break;}if(h.y>45.)break;float i=o(h);if(i<0.){e-=f;i=f/2.;}e+=i;if(i<=a||g>=100)return e;f=i;}n=0;return 500.;}float s(vec3 b,float c,vec3 d,float e){float f=clamp(c*.005,.01,.1);b=b+d*f;float g=iS.w-a*2.;for(float h=1.;h<50.;h++){vec3 c=b+iS.xyz*f;if(f>=80.||c.y>45.||c.y<g||length(b)>=150.)break;float d=m(c),i=max(a,.01*min(1.,f)+h*2e-4);if(d<=i)return 0.;e=min(e,85.*d/f);if(e<.078)return 0.;f+=d+a;}return e;}float t(vec3 a,vec3 b){float c=(iS.w-a.y)/b.y;return min(c>=0.?c:500.,500.);}vec3 u(vec2 a){vec3 b=vec3(0);float c=0.,d=1.,e=0.,g=1.-length(iP.xz-a)/500.,h=5.*g*g;for(float i=0.;i<h;++i){a+=iD.w*.5;e*=-.75;vec3 g=f(a+sin(a.yx*.5+iD.w*.5)*.5);b+=g*d;a+=g.yz*.43;a*=2.;c+=d;d*=.75;}return b/c;}vec3 v(vec3 a,float c,vec3 d){float e=min(c/500.,1.),f=b(pow(e,3.5)+1.-exp(-c*.005)),g=max(dot(d,iS.xyz),0.);vec3 h=mix(vec3(.4,.8,1),vec3(1.065,.95,.85),pow(g,10.));return mix(a,h,f);}vec3 w(vec3 a,vec3 c){vec4 d=texelFetch(tP,ivec2(FC*256./iR),0);float e=uintBitsToFloat(uint(d.x*255.)<<24|uint(d.y*255.)<<16|uint(d.z*255.)<<8|uint(d.z*255.)),f=r(a,c,.001,e),h=t(a,c);vec3 i,j=vec3(0,1,0);float k=f;vec3 l=a+c*f;bool m=h<500.&&h<f;vec3 o;float w=0.;if(m){w=mix(.2,1.,b((f-h)/3.));vec3 d=a+c*h,e=mix(vec3(0),u(d.xz*(.7-iS.w*.02))*(1.-length(d)/450.),w);j=normalize(vec3(e.y,1.,e.x));h-=abs(e.z)*w*.6;k=h;o=mix(vec3(.25,.52,.73),vec3(.15,.62,.83),b(abs(e.z)-w));}int x=n,y=g;if(n==0)i=vec3(.4,.8,1);else{vec3 a;if(l.y<=-2.9995){a=vec3(0,1,0);i=vec3(1);}else{i=vec3(.8);switch(x){case 1:a=q(l,f);i=mix(vec3(.93,.8,.64),mix(vec3(.69+texture(tN,l.xz*1e-4).x,.67,.65),vec3(.38,.52,.23),dot(a,vec3(0,1,0))),b(l.y*.5-1.))+texture(tN,l.xz*.15).x*.1+texture(tN,l.xz*.01).y*.1;break;case 2:a=p(l);switch(y){case 1:i=vec3(1);break;case 2:i=vec3(1,0,0);break;case 3:i=vec3(.5,0,0);break;case 4:i=vec3(.2,.1,.2);break;case 5:i=vec3(1,.95,.8);break;case-1:i=vec3(.64000005,.48000002,.32000002);break;default:vec4 b=texture(tN,l.xy*.35)*a.z+texture(tN,l.yz*.35)*a.x+texture(tN,l.xz*.35)*a.y-.5;i+=.125*(b.x-b.y+b.z-b.w);break;}}j=normalize(mix(a,j,w));}}float z=m||x==2&&y>0?pow(b(dot(iS.xyz,reflect(c,j))),50.):0.,A=b(dot(iS.xyz,j)),B=b(dot(iS.xyz*vec3(-1,1,-1),j)),C=A+B*.15;if(x==1)C=pow(C*mix(.9,1.02,A*A),1.+A*.6);C=mix(C,A,w);float D=1.;if(n!=0)D=s(a+c*k,k,j,1.);i=mix(i,o,w);i=(i*vec3(1.065,.95,.85)*C+z)*mix(.38+(1.-C)*.2,1.,D);return v(i,k,c);}void main_c(){vec3 a=vec3(0,0,1);a.xz*=k(FC.x*.049087387+3.1415927);oC=d(.2-o(vec3(iP.x,iP.y+(FC.y/64.-1.)-.8,iP.z)+normalize(a)*.15));}void main_p(){vec2 b=FC/128.-1.+.001953125;vec3 c=normalize(iM*vec3(b.x*-1.5,b.y,2.4142134));float d=r(iP,c,.0046875,.15);uint e=floatBitsToUint(d>=150.?150.:d-a);oC=vec4(float(e>>24&255u)/255.,float(e>>16&255u)/255.,float(e>>8&255u)/255.,float(e&255u)/255.);}void main_m(){vec2 a=FC/(iR*.5)-1.;vec3 b=normalize(iM*vec3(a.x*-1.5,a.y,2.4142134));oC=vec4(w(iP,b),1);}float x(vec2 a,float c,float d,float e,float f){vec2 g=a-vec2(c,d);return b(1.-smoothstep(e-e*f,e,dot(g,g)*4.));}void main_h(){vec2 a=FC/(iR*.5)-1.,e=vec2(1.3,1),g=vec2(0);float h=0.,i=1.,j=1.,l=0.,m=1.;while(m<11.){vec3 b=f(21.1+a*e*k(m++*2.5));g+=b.yz;h+=j*(1.-b.x)/(1.+dot(g,g));i+=j*(.5-b.x);l+=j;j*=.5;e*=1.8;}h/=l;i*=.5;float n=length(a*(1.2-i+h))*b(i+.56-.5*h*a.x*(1.-a.y*.5)),o=x(a,-.45,-.52,1.,2.3)+x(a,-.6,-.1,1.,3.3)+x(a,.5,-.7,1.,5.)+x(a,.6,.53,h*2.,i*5.);n=b(1.-c(n,1.-mix(0.,h*2.,o),.05+i*.5));vec2 p=1.-abs(a)+h*.04;n=c(n,c(p.x,p.y,.3)*2.,.1);oC=d(c(h,n,.01)*1.33-.045);}".replace("main_"+e,"main")),Se.linkProgram(t),Se.useProgram(t);const a=Se.getUniformLocation(t,"tN"),o=Se.getUniformLocation(t,"tH"),n=Se.getUniformLocation(t,"tP"),l=Se.getUniformLocation(t,"iR"),r=Se.getUniformLocation(t,"iM"),v=Se.getUniformLocation(t,"iS"),m=Se.getUniformLocation(t,"iP"),x=Se.getUniformLocation(t,"iD");return[a,o,n].map((e,t)=>Se.uniform1i(e,t)),(e,c,a)=>{Se.viewport(0,0,e,c),Se.useProgram(t),Se.uniform2f(l,e,c);const o=.2*f(2*I+3);B(D(S,.4+.1*i(.02*I),.44+.1*f(.02*I)-.05,-.38)),Se.uniform4f(v,S.x,S.y,S.z,o),Se.uniform3f(m,K.x,K.y+(a?0:Y),K.z),Se.uniform4f(x,$.x,$.y,$.z,I),Se.uniformMatrix3fv(r,!1,ee)}};let Fe,Ne,Pe;const Re=Se.createTexture(),Me=Se.createTexture(),He=Se.createTexture(),Be=Se.createFramebuffer(),Ie=new c(65536),qe=(e,t)=>{const c=512*t+4*e;return Ie[c]/255+Ie[c+1]/65025+Ie[c+2]/16581375+Ie[c+3]/40948250625},Te=e=>-m*(e-64)/64-m/2,We=Se.createTexture(),Ee=[Q,{v:!1,u:!1,h:!1},E,K,Z],Le=()=>localStorage.getItem("joiners30-12-20");ge.onclick=()=>{ke&&(localStorage.setItem("joiners30-12-20",JSON.stringify(Ee)),J("Saved",2),je(!1),ze.className="")},ze.onclick=()=>{const e=Le();e&&(G.length=0,V=U,le.innerHTML="",je(!1),a(Ee,JSON.parse(e)),J("Game loaded",2))},ze.className=Le()?"":"X",setTimeout(()=>{(()=>{Se.activeTexture(33984),Se.bindTexture(3553,Me);const e=new c(1048576);let a=737,i=254265,o=1082,t=345;for(let c=0;512>c;++c){const n=2048*c,l=((c-1)%512+512)%512*2048;for(let c=0;512>c;++c){const r=a<<9;let f=5*t;f=9*(f<<7|f>>>25),o^=t,i^=a,a^=o,t^=i,o^=r,i=i<<11|i>>>21,f&=255;const v=4*c,m=((c-1)%512+512)%512*4;e[v+n]=f,e[m+n+1]=f,e[v+l+2]=f,e[m+l+3]=f}}Se.texImage2D(3553,0,6408,512,512,0,6408,5121,e),Se.hint(33170,4354),Se.generateMipmap(3553),Ae(10497,9987,9729)})(),Se.activeTexture(33985),Se.bindTexture(3553,Re),Se.texImage2D(3553,0,6408,4096,4096,0,6408,5121,null),Se.bindFramebuffer(36160,_e),Se.framebufferTexture2D(36160,36064,3553,Re,0),De("h")(4096,4096),Se.drawArrays(4,0,3),Se.generateMipmap(3553),Ae(33071,9987,9729),Se.bindFramebuffer(36160,null),Se.activeTexture(33986),Se.bindTexture(3553,We),Se.texImage2D(3553,0,6408,256,256,0,6408,5121,null),Ae(33071,9728),Se.bindFramebuffer(36160,_e),Se.framebufferTexture2D(36160,36064,3553,We,0),Se.bindFramebuffer(36160,null),Se.activeTexture(33989),Se.bindTexture(3553,He),Se.texImage2D(3553,0,6408,128,128,0,6408,5121,null),Se.bindFramebuffer(36160,Be),Se.framebufferTexture2D(36160,36064,3553,He,0),Fe=De("m"),Pe=De("c"),Ne=De("p"),pe();const e=c=>{t(e),((e,t)=>{const c=e/1e3,a=c-T;return T=c,t?(q=0,c-W>=.2&&(W=c,!0)):(q=r(a,.033),I+=q,q>0)})(c,re)&&((()=>{const e=(z[5]?5.5:2.1)*q;Q.i||(D(S,0,0,0),z[1]&&te(1),z[2]&&te(-1),z[3]&&ce(-1),z[4]&&ce(1),(S.x||S.z)&&(oe+=q,Y=xe?.03*f(10*oe):0,M(K,H(B(S),e)))),ae()})(),re||(Q.i||(()=>{Pe(128,128,!0),Se.bindFramebuffer(36160,Be),Se.drawArrays(4,0,3),Se.readPixels(0,0,128,128,6408,5121,Ie),Se.bindFramebuffer(36160,null);let e=0;for(let c,t=0;128>t;t++){c=-99;for(let e=0;32>e;e++)c=l(qe(t,e),c);e+=c}const t=e/128-.2;let a=0,c=0;for(let e=32;96>e;++e)for(let t=0;64>t;++t){const n=t+64,l=qe(t,e),r=qe(n,e),v=Te(t),m=Te(n),x=i(v)*l+i(m)*r,s=f(v)*l+f(m)*r;o(x)>o(c)&&(c=x),o(s)>o(a)&&(a=s)}K.x+=c,K.y=l(K.y+t,.9),K.z+=a;const n=R(K);100>n||(K.x*=100/n,K.z*=100/n)})(),(()=>{O=!1;for(const e of L)e.g&&(e.p&&(O=e.p(e.C)),e.C+=e.k*q*e.g,(e.C>e.j||e._>e.C)&&(e.C=e.g>0?e.j:e._,e.F&&e.F(),e.g=0))})(),(()=>{const e=(()=>{for(const e of X)if(e.P){const t=e.N;if(v((({x,y,z},a)=>(a.x-x)**2+(a.y-y)**2+(a.z-z)**2)(t,K))<=e.R&&N($,B(F(S,t,K,u)))>.9)return e}})();J(e&&e.H()||""),e&&z[6]&&e.B()})(),V&&V.o>0&&(V.o-=q),0>V.o&&G[0]&&(V=G.pop(),le.innerHTML=V.t)),Ne(256,256),Se.bindFramebuffer(36160,_e),Se.drawArrays(4,0,3),Se.bindFramebuffer(36160,null),Fe(fe,ve),Se.drawArrays(4,0,3))};t(e)},99)})()})(this)</script></body></html>