<html><head><title>üèù</title><meta content="width=device-width,initial-scale=1" name=viewport><style>*{user-select:none}body,html{margin:0;padding:0}#M,body{align-items:center;display:flex;justify-content:center;height:100%;text-shadow:0 0 8px #000,-1px -1px 3px #000,1px 1px 3px #000;background:#000;color:#fca;text-align:center;font-family:Papyrus,Gabriola,'Times New Roman',Times,serif}#M{position:relative;letter-spacing:.01em}input{width:1.2rem;height:1.2rem;vertical-align:middle}#V{width:15em}#N,#T{position:absolute}#N{top:0;display:none;width:100%;height:100%;backdrop-filter:blur(15px) contrast(200%) brightness(35%)}b{cursor:pointer}b:hover{text-decoration:underline}.X{opacity:.5;cursor:no-drop}.X:hover{text-decoration:none}#T{padding:2px;bottom:0}h1,h3{margin:.2em}small{display:block;margin:.55em}label{margin:.4em}@-moz-document url-prefix(){.N #C{filter:blur(15px) contrast(190%) brightness(50%)}}.N #T{display:none}.N #N{display:block}a,a:active,a:visited{opacity:.7;font-size:.6em;color:#fca}a:hover{opacity:1}</style></head><body class=L><div id=M><canvas id=C></canvas><div id=T><h1>Loading...</h1></div><div id=N><h1>ISLAND NOT FOUND</h1><h3><b id=R>New Game</b></h3><h3><b id=S class=X>Save Game</b></h3><h3><b id=L>Load Game</b></h3><small><label><input id=Y type=checkbox> Invert Y</label><label><input id=Q type=checkbox checked> High quality</label><label><input id=H type=checkbox checked> Head Bob</label><br><label>Music Volume <input id=V type=range value=50></label><br><br>Shift: run<br>W,A,S,D/Z,Q,S,D/Arrows: move<br>Mouse: look around<br>E,Space: interact<br>F: flashlight<br>Esc,M: menu</small><a href=https://github.com/SalvatorePreviti/js13k-2020 target=_blank>Copyright (c) 2020 Ben Clark, Salvatore Previti.</a></div></div><script>(({document:e,Int32Array:a,Uint8Array:t,requestAnimationFrame:o})=>{!function(){function c(e,a=1){e.t=a>0?e.o:e.l,e.v=a}function n(e,a){for(const t in a)"object"==typeof a[t]?n(e[t],a[t]):e[t]=a[t]}const{abs:i,cos:l,floor:r,max:f,min:v,random:s,sin:m,sqrt:b,PI:u}=Math,x=2*u,_=u/180,d=(e,a,t)=>v(f(e,a),t),y=(e,a)=>e+a,h=(e,a)=>e-a,z=(e,a)=>e*a,g=(e,a)=>e/a,{assign:p,values:k}=Object,A=[],w={},D={w:1,W:1,z:1,Z:1,ArrowUp:1,s:2,S:2,ArrowDown:2,a:3,A:3,q:3,Q:3,ArrowLeft:3,d:4,D:4,ArrowRight:4,Shift:5,e:6,E:6," ":6,f:7,F:7,Escape:8,M:8,m:8},S=(a,t)=>{if(!a.keyCode||a.metaKey||!e.activeElement||Se)A.length=0;else{const e=0|D[a.key];t&&w[e]&&w[e](a.repeat),A[e]=t}};onkeydown=e=>S(e,!0),onkeyup=e=>S(e,!1);const L=(x,y,z)=>({x,y,z}),I=(e=0)=>({x:e,y:e,z:e}),F=I(),j=I(),C=L(0,1,0),N=(e,a,t,o)=>(e.x=a,e.y=t,e.z=o,e),P=(e,{x,y,z},c,n)=>N(e,n(x,c.x),n(y,c.y),n(z,c.z)),R=(e,{x,y,z},c,n)=>N(e,n(x,c),n(y,c),n(z,c)),B=({x,y,z},o)=>x*o.x+y*o.y+z*o.z,E=e=>b((({x,y,z})=>x**2+y**2+z**2)(e)),M=(e,a,t=e)=>P(e,a,t,y),O=(e,a,t=e)=>R(e,t,a,z),q=(e,a=e)=>((e,a,t)=>R(e,a,t,g))(e,a,E(a)),T=(e,a,t)=>(e.x=a,e.y=t,e);let H=0,K=0,U=0,X=.033;const W={u:"",_:-1};let J=W;const G=[],V=(u,a=-1)=>{const t=u||a>0?{u,_:a}:W;G[0]?0>a?G[0]=t:G.splice(1,0,t):(G.unshift(t),a>0&&G.unshift(W))},Q={h:0,g:0,k:0},Y={L:!1,I:!1,j:!1,C:!1},Z={L:{N:L(-45.5,2,7.4),P:!0,R:2,B(){this.P=!1,Y.L=!0,V("You picked up a key",3)},O:()=>"A key, how convenient! [press E or Space to collect]"},j:{N:L(-42,3,11.2),P:!0,T:!1,R:1.5,B(){this.P=!1,Y.j=!0,V("You picked up the flashlight. [Press F to activate/deactivate]",3)},O:()=>"Pick up the flashlight [press E or Space]"},H:{N:L(-40.5,4.5,11),P:!0,R:2.8,B(){},O:()=>"That looks like a big antenna, maybe I can call for help if I can make it there\u2026"},X:{N:L(8.5,14,2),P:!0,R:2.5,K:!1,B(){Y.I&&(this.P=!1,c(ee.X)),this.K=!0},O(){return this.K?"A locked door\u2026 The symbol on it looks familiar":"A door"}},I:{N:L(0,1e3,0),P:!0,R:2.5,B(){Y.I=!0,this.P=!1,Z.U.P=!0,c(ee.J,-1)},O:()=>"A key"},G:{N:L(5.7,14.2,-1.9),P:!0,R:1.5,B(){ie.z>0||(this.P=!1,c(ee.V),Z.Y.P=!1)},O:()=>ie.z>0?"":"A lever [press E or Space]"},$:{N:L(4.8,14.4,3.7),P:!0,R:1.5,B(){4===Q.h&&(Q.h=5),ee.ee.v&&Y.C&&0===Q.h&&(Q.h=2,c(ee.ae),N(oe,5.844,14.742,4),T(ne,-90*_,17*_))},O:()=>4===Q.h?"A submarine? That's my way out! [Press E or Space to continue]":0===Q.h?ee.ee.v?Y.C?"Insert the floppy disk":"Damn, I need to find this floppy disk":"There is no electricity, there must be a generator somewhere on this damn island":""},U:{N:L(47.5,4,30.5),P:!0,R:1.5,B(){Y.I&&V("I already got the key",2),c(ee.J),this.P=!1},O(){return"A button [press E or Space]"}},Y:{N:L(11.8,2,-34.3),P:!0,R:5,B(){},O:()=>"This bridge looks broken"},te:{N:L(26.6,5.5,-55.6),R:2.5,P:!0,B(){c(ee.oe),this.P=!1},O(){return"A Lever"}},ce:{N:L(26,13.5,-52.9),P:!0,R:2,B(){c(ee.ce),this.P=!1},O:()=>"A big wheel, I suppose it will feed fuel to the generator\u2026"},ne:{N:L(-43,3.4,15),R:2.2,P:!0,K:!1,B(){Y.L&&(this.P=!1,c(ee.ne),Z.H.P=!1),this.K=!0},O(){return Y.L?"Open the door with the key [press E or Space]":this.K?"A locked door, I need a key":"A door [press E or Space to open]"}},ie:{N:L(12.2,22.3,38.7),R:2,P:!0,B(){this.P=!1,Y.C=!0},O:()=>"A floppy disk"},le:{N:L(9.3,2,36.1),R:2,P:!0,B(){ee.ee.v&&(ee.re.t===ee.re.o&&c(ee.re),ee.re.t===ee.re.l&&c(ee.re,-1))},O(){return ee.ee.v?ee.re.t===ee.re.o?"Activate":ee.re.t===ee.re.l?"Call elevator":"":"Elevator is out of order"}},fe:{N:L(9.3,22.5,36.1),R:2,P:!0,B:()=>Z.le.B(),O(){return ee.re.t===ee.re.l?"Activate":ee.re.t===ee.re.o?"Call elevator":""}},ve:{N:L(-46.5,2,-28.5),R:5,P:!1,O:()=>"A submarine! My way out. [press E or Space to Escape!]",se:!1,B(){this.se=!0,c(ee.ve,-1),localStorage["OS13kTrophy,\u{1f3dd},Island Not Found"]="Found a way out!",N(oe,-42,12,-47),T(ne,-12.7*_,33.7*_),V("",3),V("<h1>The End</h1><h2>you found your way out</h2><h3>Game by Salvatore Previti & Ben Clark</h3>Thank you for playing!",1e4)}}},$=k(Z);w[7]=e=>!e&&(Z.j.T=Y.j&&!Z.j.T);const ee={ne:{t:0,me:1.1,o:0,l:1,v:0},X:{t:0,me:.2,o:0,l:1,v:0},J:{t:0,me:.3,o:0,l:1,v:0,be(){Z.I.N=L(46.4,4.6,29.4)},ue:()=>!0},V:{t:0,me:1.2,o:0,l:19,v:0,ue:e=>.5>e||e>18.8},ce:{t:0,me:3,o:0,l:10,v:0,be(){c(ee.ee)}},ee:{t:0,me:.5,o:0,l:1e9,v:0},re:{t:1,o:-19.2,l:1,me:4,v:0,ue:e=>-19>e||e>.8},ae:{t:0,o:0,l:1,me:1,v:0,be(){Q.h=3}},ve:{t:-10,o:-10,l:4,me:1,v:0},oe:{t:0,o:0,l:1,me:1,v:0}},ae=k(ee);let te=!1;const oe=L(103,44,9);let ce=0;const ne={x:-102*_,y:23*_},ie=I(),le=new Float32Array(9),re=e=>M(F,O(q(N(j,ie.x,0,ie.z)),e)),fe=e=>M(F,O(q(((e,{x,y,z},{x:c,y:n,z:i})=>N(e,y*i-z*n,z*c-x*i,x*n-y*c))(j,ie,C)),e)),ve=()=>{let{x:e,y:a}=ne;te&&(e+=.005*m(100*H),a+=.005*m(200*H));const t=m(e),o=l(e),c=m(a),n=l(a);q(N(ie,t*n,-c,o*n)),((e,...a)=>{e.set(a)})(le,o,0,-t,t*c,n,o*c,t*n,-c,o*n)};let se=0;ve(),onmousemove=a=>{var t;e.pointerLockElement!==we||Z.ve.se||(ne.x=(t=ne.x-.001*a.movementX)-x*r((t+u)/x),ne.y=d(ne.y+a.movementY*Fe*.001,-87*_,87*_))};const me={xe:[{i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,51,2,1,2,58,239,0,32,88,1,157,2],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,,,,1,1,,,1,1,1,1],c:[{n:[146],f:[]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[,,,,1,2,1,2,3,4,3,4,3,4,3,2,4,3,4,3,4,3,4,3,2],c:[{n:[127,,,,,,,,,,,,,,,,135],f:[]},{n:[127,,,,,,,,,,,,,,,,128],f:[]},{n:[127,,,,,,,,135,,,,,,,,127,,,,,,,,140],f:[]},{n:[127,,,,,,,,135,,,,,,,,127,,,,,,,,128],f:[]}]},{i:[0,84,108,1,0,88,116,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[,,,,,,,1,2,2,2,2,2,,,1,2,2,2,1,2,2,2],c:[{n:[,,,,,,,,,,,,,,,,144,,,,144,,,,144,,144,,144,144,144,144],f:[]},{n:[144,,,,144,,,,144,,,,144,,,,144,,,,144,,,,144,,,,144],f:[]}]},{i:[1,0,128,0,1,0,128,0,0,255,158,100,158,0,0,3,67,4,1,3,57,254,85,171,88,1,157,2],p:[,,,,,,,,,1,,1,,,,,1],c:[{n:[134],f:[]}]}],_e:6615,de:32,ye:24,he:4},be=e=>m(6.283184*e),ue=e=>{const a=e%1*4;return 2>a?a-1:3-a},xe=e=>.003959503758*2**((e-128)/12),_e=[be,e=>.5>e%1?1:-1,ue,ue];let de,he,ye,ze;const ge=(e,t,o)=>{const c=_e[e.i[0]],n=e.i[1],i=e.i[3],l=_e[e.i[4]],r=e.i[5],f=e.i[8],v=e.i[9],m=e.i[10]*e.i[10]*4,b=e.i[11]*e.i[11]*4,u=e.i[12]*e.i[12]*4;let _=e.i[13];const d=o*2**(2-e.i[14]),y=new a(m+b+u);let A,g,h,k,p,w,z,D=0,S=0;for(h=0,z=0;m+b+u>h;h++,z++)0>z||(_=_>>8|(255&_)<<4,z-=d,A=xe(t+(15&_)+e.i[2]-128),w=xe(t+(15&_)+e.i[6]-128)*(1+8e-4*e.i[7])),g=1,m>h?g=h/m:m+b>h||(g-=1/u*(h-m-b)),p=A,i&&(p*=g*g),D+=p,k=c(D)*n,p=w,f&&(p*=g*g),S+=p,k+=l(S)*r,v&&(k+=(2*s()-1)*v),y[h]=0|80*k*g;return y},pe=()=>{let b,c,e,f,i,l,n,o,r,s,t,v;const u=new a(he),x=me.xe[ye],_=me._e,d=me.de;let y,h,z=0,g=0,p=!1,k=[];for(o=0;de>=o;++o)for(l=x.p[o],c=0;d>c;++c){const a=l?x.c[l-1].f[c]:0;a&&(x.i[a-1]=x.c[l-1].f[c+d]||0,16>a&&(k=[]));const A=_e[x.i[15]],w=x.i[16]/512,D=2**(x.i[17]-9)/_,S=x.i[18],L=x.i[19],I=135.82764118168*x.i[20]/44100,F=1-x.i[21]/255,j=1e-5*x.i[22],C=x.i[23]/32,N=x.i[24]/512,P=6.283184*2**(x.i[25]-9)/_,R=x.i[26]/255,B=-2&x.i[27]*_;for(s=(o*d+c)*_,n=0;4>n;++n)if(i=l?x.c[l-1].n[c+n*d]:0,i){k[i]||(k[i]=ge(x,i,_));const a=k[i];for(t=0,e=2*s;a.length>t;t++,e+=2)u[e]+=a[t]}for(t=0;_>t;t++)r=2*(s+t),v=u[r],v||p?(b=I,S&&(b*=A(D*r)*w+.5),b=1.5*m(b),z+=b*g,y=F*(v-g)-z,g+=b*y,v=3===L?g:1===L?y:z,j&&(v*=j,v=1>v?v>-1?be(.25*v):-1:1,v/=j),v*=C,p=v*v>1e-5,f=m(P*r)*N+.5,h=v*(1-f),v*=f):h=0,B>r||(h+=u[r-B+1]*R,v+=u[r-B]*R),u[r]=0|h,u[r+1]=0|v,ze[r]+=0|h,ze[r+1]+=0|v}return ye++,ye/me.he},ke=new Audio,Ae=e.body,we=e.getElementById("C"),De=e.getElementById("T");let Se,Le,Ie,Fe=1,je=!0;const Ce=e.getElementById("M"),Ne=e.getElementById("R"),Pe=e.getElementById("Q"),Re=e.getElementById("Y"),Be=e.getElementById("V"),Ee=e.getElementById("H"),Me=e.getElementById("S"),Oe=e.getElementById("L"),qe=()=>{let e=v(1200,innerWidth-30),a=innerHeight-30;e/a>1.5?e=1.5*a:a=e/1.5;const t={width:0|e,height:0|a,fontSize:(0|a/23)+"px"};p(Ce.style,t),p(we.style,t);let{clientWidth:o,clientHeight:c}=Ce;Pe.checked||(o=0|o/2,c=0|c/2),Le=o,Ie=c,we.width=o,we.height=c},Te=()=>{ke.pause(),Se=!0,Ae.className="N",e.exitPointerLock()};e.onpointerlockchange=()=>{e.pointerLockElement||Te()};const He=e=>(!e||!e.button)&&!Se&&we.requestPointerLock();let Xe;const Ke=(e=!0)=>{Xe||(Me.className="",e&&V("Where am I? How did I get here?",2),Ne.innerText="Resume Game",N(oe,-44,4,11),T(ne,70*_,0*_),Xe=!0),ke.play(),Se=!1,Ae.className="",He()};qe(),onresize=qe,Ne.onclick=()=>Ke(),w[8]=Te,we.onmousedown=He,Pe.onchange=qe,Re.onchange=()=>Fe=Re.checked?-1:1,Ee.onchange=()=>je=Ee.checked,Be.onchange=()=>ke.volume=Be.value/100;const Ue=we.getContext("webgl2",{alpha:!1,desynchronized:!0,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,powerPreference:"high-performance",preserveDrawingBuffer:!1,stencil:!1}),We=Ue.createFramebuffer(),Je=(e=10497,a=9729,t=a)=>{Ue.texParameteri(3553,10242,e),Ue.texParameteri(3553,10243,e),Ue.texParameteri(3553,10241,a),Ue.texParameteri(3553,10240,t)},Ge=e=>{const a=Ue.createProgram(),t=(e,t)=>{const o=Ue.createShader(e);return Ue.shaderSource(o,t),Ue.compileShader(o),Ue.attachShader(a,o),o};t(35633,"#version 300 es\nprecision mediump int;uniform vec2 iR;out vec2 FC;void main(){vec2 a=vec2(float((gl_VertexID&1)<<2),float((gl_VertexID&2)<<1));gl_Position=vec4(a-1.,0.,1.);FC=a*iR*.5;}"),t(35632,"#version 300 es\nprecision highp float;in vec2 FC;uniform vec2 iR;uniform vec3 iP;uniform vec4 iD;uniform vec4 iA;uniform vec4 iB;uniform vec4 iC;uniform vec4 iS;uniform vec4 iX;uniform mat3 iM;uniform lowp int iF;out vec4 oC;uniform highp sampler2D tN;uniform highp sampler2D tH;uniform highp sampler2D tP;uniform highp sampler2D tS;float a;float b(float a){return clamp(a,0.,1.);}float c(float a,float b,float c){float d=max(c-abs(a-b),0.)/c;return min(a,b)-d*d*c/4.;}vec4 d(float a){vec4 c=b(a)*vec4(.999998,254.99948,65024.867,160581056);c=fract(c);c-=c.yzww*vec4(.003921569,.003921569,.003921569,0);return c;}float e(vec4 a){return dot(a,vec4(1,.003921569,1.53787e-5,6.2273724e-9));}vec3 f(vec2 a){vec4 b=texelFetch(tN,ivec2(floor(a))&511,0);float c=b.y-b.x,d=b.z-b.x,e=b.w-c-b.z;vec2 f=fract(a),g=f*f,h=g*(3.-2.*f);return vec3(b.x+c*h.x+d*h.y+e*h.x*h.y,30.*g*(f*(f-2.)+1.)*(vec2(c,d)+e*h.yx));}int g=0;float h=150.;void i(int b,float c){if(c<a&&c!=h){g=b;h=c;}}float j(vec3 a,float b){return length(a)-b;}float k(vec3 a,vec3 b){vec3 c=abs(a)-b;return min(max(c.x,max(c.y,c.z)),0.)+length(max(c,0.));}float l(vec3 a,float b){vec3 c=abs(a)-b;return min(max(c.x,max(c.y,c.z)),0.)+length(max(c,0.));}float m(vec3 a,float b,float c){float d=length(a.xy)-b;return max(d,abs(a.z)-c);}float n(vec3 a,vec2 b){return length(vec2(length(a.xz)-b.x,a.y))-b.y;}float o(float a,float b,float c,float d){float e=b*.5,f=floor((a+e)/b),g=mod(a+e,b)-e;return f>d?g+b*(f-d):f<c?g+b*(f-c):g;}vec2 p(vec2 a,float b){float c=3.1415927/b,d=mod(atan(a.y,a.x)+c,c*2.)-c;return vec2(cos(d),sin(d))*length(a);}vec2 q(vec2 a,float b,float c){float d=3.1415927/b,e=mod(atan(a.y,a.x)+d+c,d*2.)-d;return vec2(cos(e),sin(e))*length(a);}float r(float a,float b){return abs(a)-b;}mat2 s(float a){float b=cos(a),c=sin(a);return mat2(b,c,-c,b);}vec3 t(vec3 a){return vec3(a.xy,-a.z);}float u(vec3 a){float b=length(a)-.3;if(b>.3)return b;a.xz*=s(-1.2);a.yz*=s(-.2);return min(m(a,.025,.1),max(j(a-vec3(0,0,.12),.05),a.z-.12));}float v(vec3 a){float b=length(a)-.3;if(b>.3)return b;float c=m(a,.01,.06);c=min(c,m(a.yzx+vec3(0,.1,0),.04,.005));c=min(c,k(a-vec3(0,-.01,.04),vec3(.002,.02,.02)));return c;}float w(vec3 a){float b=k(a-vec3(.03,0,0),vec3(.03,.006,.03));i(1,b);return min(k(a,vec3(.06,.005,.06)),b);}float x(vec3 a,float b,float c){float d=length(a)-b*.6;if(d>4.)return d;a.y+=cos(a.z*c/b);a.x=abs(a.x);float e=k(a-vec3(.2,0,0),vec3(.1,.03,b*.55)),f=m(a-vec3(.5,1,0),.02,b*.55);a.z=o(a.z,.55,-b,b);f=min(f,m(a.xzy-vec3(.5,0,.5),.02,.5));i(1,f);e=min(e,k(a,vec3(.5,.05,.2)));i(-1,e);return min(e,f);}float y(vec3 a){float b=length(a)-2.;if(b>1.)return b;vec3 c=a;c.xy*=s(-.25);float d=k(c+vec3(.2,.25,0),vec3(.25,.5,.5))-.01;c-=vec3(-.13,.25,0);c.z=o(c.z,.04,-10.,10.);c.x=o(c.x,.04,-3.,3.);float e=l(c,.01)-.005;i(1,e);d=min(min(d,e),k(a-vec3(-.45,.2,0),vec3(.2,.8,.5))-.01);return d;}float z(vec3 a){a.zy*=s(.06);a.y+=cos(a.z/20.)*3.;return m(a,.01,27.5);}float A(vec3 a){float b=length(a)-3.;if(b>.5)return b;a.xz-=vec2(1,-.05);a.zx*=s(iA.y*-2.5);a.xz+=vec2(1,-.05);float c=m(a,.99,.05);vec3 d=vec3(p(a.xy,8.),a.z);return max(c,-min(k(d-vec3(.5,0,.1),vec3(.02,.1,.1)),m(d-vec3(0,0,.1),.02,.1)));}float B(vec3 a,float b){float c=length(a)-1.;if(c>1.)return c;float d=k(a,vec3(.2,.5,.05));d=max(d,-k(a,vec3(.03,.2,1)));a.yz*=s(-1.5707964*b+.7853982);a.z+=.2;d=min(d,m(a,.02,.2));a.z+=.2;d=min(d,m(a,.03,.05));return d;}float C(vec3 a){float b=length(a)-18.;if(b>5.)return b;a.y-=9.;vec3 c=a;c.xz*=s(iB.y);c.xy*=s(.5);c.y-=9.;float d=j(c,9.),e=max(r(d,.01),c.y+4.5);e=min(e,m(c.xzy+vec3(0,0,4.5),.1,4.5));e=min(e,j(c,.3));a.y+=6.75;float f=k(a,vec3(2.25,3.6,4.5));f=min(f,min(max(r(m(a.xzy-vec3(2.25,0,0),4.4,3.5),.1),-min(m(a.zyx-vec3(0,1.8,0),1.,100.),m(a-vec3(4.5,2.3,0),.4,100.))),m(a.xzy-vec3(2.25,0,-2.2),4.4,2.9)));float g=y(a-vec3(3,1.5,2)),h=A(a.zyx-vec3(0,1.8,6.5)),l=B(t(a-vec3(3.7,2,-4)),clamp(iA.w,0.,1.));a.y-=2.25;f=max(min(f,m(a.xzy,.45000002,4.7699995)),-d);a-=vec3(7,-2.85,0);a.xy*=s(-.5);f=min(f,k(a,vec3(1,1,.8))-.01);float n=min(e,h);i(2,l);i(3,g);i(5,n);return min(min(g,f),min(n,l));}float D(vec3 a){float b=length(a.xz)-2.;if(b>3.)return b;float c=m(a.xzy,.2,.5),d=a.y+iA.z*4.;if((iF&8)!=0){float b=v(vec3(a.x,d,a.z)+vec3(1.05,-5.05,1.05));if(b<c){i(2,b);c=b;}}float e=k(vec3(p(a.xz,8.),d).xzy-vec3(1.5,0,0),vec3(.1,5,.2));if(e<c){i(4,e);c=e;}float f=m(a.xzy+vec3(0,0,clamp(iA.z,0.,.02)),.05,.53);if(f<c){i(1,f);c=f;}return c;}float E(vec3 a){vec3 b=a.zyx-vec3(11,1.25,-44);float c=length(b)-8.;if(c>5.)return c;b.y-=2.;float d=k(b-vec3(-2.7,-1,-1.3),vec3(.35,.5,.5)),e=max(r(k(b,vec3(4,1.6,2)),.23),-min(m(b-vec3(0,.5,0),.8,100.),k(b-vec3(4,-.37,1),vec3(2,1,.53))));vec3 f=b-vec3(4,-.77,.5);f.xz*=s(-iA.x*3.1415927/2.);float g=k(f-vec3(0,.4,.5),vec3(.05,.99,.52));b.x=o(b.x,.3,-10.,10.);b.z=abs(b.z);float h=m(b.xzy-vec3(0,2,.5),.01,1.),j=min(d,g);i(1,h);i(-1,j);float l=min(h,min(e,j)),n=150.;if((iF&4)!=0)n=u(a-vec3(-42,3,11.2));if((iF&2)!=0)n=min(n,v(a.yzx-vec3(2,7.4,-45.5)));if(n<l){i(2,n);return n;}return l;}float F(vec3 a){float b=length(a)-9.;if(b>1.)return b;a.xz*=s(-.7853982);float d=k(a-vec3(-1.5,1,5),vec3(1,.2,3));a.y-=iB.w;vec3 e=a.xzy-vec3(-2,0,2);float f=c(j(a-clamp(a,vec3(-6,0,0),vec3(6,0,0)),1.7),min(m(e-clamp(e,vec3(-.5,0,0),vec3(.5,0,0)),.4,.5),min(k(a-vec3(7.5,0,0),vec3(.3,2,.05))-.05,k(a-vec3(7.5,0,0),vec3(.3,.05,2))-.05)),.3);i(3,f);return min(d,f);}float G(vec3 a){float b=length(a)-13.;if(b>3.)return b;vec3 c=abs(a),d=vec3(c.x,abs(a.y-4.58),c.z);float e=B(t(a.xzy-vec3(1.9,-1.5,.2))*.5,min(1.,(6.-iX.x)*.2))/.5,f=max(k(vec3(a.x,abs(a.y-3.5)-3.5,a.z),vec3(6,.2,6))-.05,max(-l(a-vec3(2,7,2),1.5),-l(a-vec3(5.7,0,4),.52)));vec3 g=a-vec3(5,7.6,-2);g.xy*=s(.3);vec3 h=vec3(a.xy,abs(a.z+2.));e=min(e,min(min(m(h.xzy-vec3(-6,1.1,8.7),1.,1.75),m(h.xzy-vec3(-6.5,1.1,0),.2,8.)),m(vec3(a.z,abs(a.y-7.6),a.x)-vec3(-3,.2,0),.1,5.)));float j=min(min(min(m(vec3(c.xz,a.y)-vec3(5,5,0),.5,8.3),m(d.zyx-vec3(5.3,3.5,0),.05,5.3)),max(m(d-vec3(5.3,3.5,0),.05,5.3),-l(a-vec3(5,.7,4),.8))),k(g,vec3(.5,.6,1.5))-.05);i(1,j);vec3 o=a-vec3(2,3.59,-.1);o.zy*=s(-.7853982);o.y-=iX.x;e=min(e,k(o,vec3(1,5.1,.02))-.05);i(5,e);float p=min(min(f,e),j);vec3 r=g-vec3(0,.8,0);if(length(r)-1.<2.){float a=min(min(n(r,vec2(.5,.02)),m(r.xzy+vec3(0,0,.5),.02,.5)),m(vec3(q(r.xz,5.,iB.x),r.y).zyx-vec3(0,0,.25),.01,.25));if(a<p){i(2,a);p=a;}}return p;}float H(vec3 a){vec3 b=a.zyx-vec3(4,-1,17);b.zy*=s(-.19);b.z-=19.-iA.w;return min(x(b,21.,0.),m(b.xzy+vec3(0,10.5,6),.15,5.));}float I(vec3 a){vec3 b=a-vec3(8.7,9.3,37);float c=length(b.xz)-5.;if(c>4.)return c;vec3 d=vec3(p(b.xz,6.),b.y).xzy,e=vec3(d.x,o(b.y,1.5,-3.,7.),d.z);float f=max(max(min(m(b.xzy,1.1,12.),max(r(m(b.xzy-vec3(0,0,14),4.,2.),.2),-k(d-vec3(4,14,0),vec3(1,1,2)))),-min(m(b.xzy,1.,13.),k(e-vec3(1,0,0),vec3(.2,.3,.13)))),-k(b+vec3(0,7,1),vec3(.8,1.2,.8)));vec3 g=vec3(b.x,b.y-iB.z,b.z);float h=m(g.xzy,1.,11.);g.y=o(g.y,1.5,-7.,7.);h=max(h,-n(g,vec2(1,.01)));vec3 l=vec3(b.x-.8,o(b.y-12.7,20.5,-1.,0.),b.z+.9);float q=j(l-vec3(0,.5,0),.06),s=min(m(l.xzy,.05,.5),min(k(l-vec3(0,.5,0),vec3(.05,.1,.1)),q));i(2,q);i(1,s);i(5,h);float t=min(min(f,min(s,h)),k(b+vec3(0,10.3,3),vec3(1.1,2,3)));if((iF&16)!=0){float b=w(a-vec3(12.15,22.31,38.65));if(b<t){i(2,b);return b;}}return t;}vec2 J;float K(vec3 a,vec3 b,vec2 c){a-=b;float d=length(a)-2.;if(d>.5)return d;a.xz*=s(1.5707964);J=(c-a.xy)/(c*2.);float e=k(a,vec3(c.xy,.01));return e;}float L(vec3 a){vec3 b=abs(vec3(a.x,a.y+3.,a.z))-vec3(60,0,39);if(b.x<0.&&b.z<0.)b.y-=e(textureLod(tH,a.xz/vec2(120,78)+.5,0.))*19.;return min(b.y,0.)+length(max(b,0.));}float M(vec3 a){float b=x(a-vec3(45,1.7,22.4),10.,2.),c=C(a-vec3(2,10,2)),d=D(a-vec3(47.5,3.5,30.5)),e=E(a);vec3 f=a-vec3(26,5,-58);f.xz*=s(1.9707963);float g=G(f),h=H(f),j=z(f.zyx-vec3(-2,9.7,32.5)),k=I(a),l=F(a-vec3(-46,-.5,-30)),m=min(min(min(b,c),min(d,e)),min(g,min(h,min(k,l))));if(j<m){i(1,j);return j;}i(0,m);return m;}int N=0;float O(vec3 b){float c=L(b);if(c<=a){N=1;return c;}float d=M(b),e=K(b,vec3(4.76,14.42,4),vec2(.45,.29)),f=min(e,d);if(c<f){N=1;return c;}N=e<=d?3:2;return f;}vec3 P(vec3 a){return normalize(vec3(M(a+vec3(.001,0,0)),M(a+vec3(0,.001,0)),M(a+vec3(0,0,.001)))-M(a));}vec3 Q(vec3 a,float b){vec2 c=vec2(mix(.03,.001,min(b/120.,1.)),0);return normalize(vec3(L(a+c.xyy),L(a+c.yxy),L(a+c.yyx))-L(a));}float R(vec3 b,vec3 c,float d,float e){float f=d;for(int g=0;;g++){vec3 h=b+c*e;a=d*max(e,1.);if(h.y<=-2.9995||e>=150.){float a=(-3.-b.y)/c.y;if(a>=0.&&a<500.){N=1;return a;}break;}if(h.y>45.)break;float i=O(h);if(i<0.){e-=f;i=f/2.;}e+=i;if(i<=a||g>=100)return e;f=i;}N=0;return 500.;}float S(vec3 b,float c,vec3 d,float e){float f=clamp(c*.005,.01,.1);b=b+d*f;float g=iS.w-a*2.;for(float h=1.;h<50.;h++){vec3 c=b+iS.xyz*f;if(f>=80.||c.y>45.||c.y<g||length(b)>=150.)break;float d=M(c),i=max(a,.01*min(1.,f)+h*2e-4);if(d<=i)return 0.;e=min(e,85.*d/f);if(e<.078)return 0.;f+=d+a;}return e;}float T(vec3 a,vec3 b){float c=(iS.w-a.y)/b.y;return min(c>=0.?c:500.,500.);}vec3 U(vec2 a){vec3 b=vec3(0);float c=0.,d=1.,e=0.,g=1.-length(iP.xz-a)/500.,h=5.*g*g;for(float i=0.;i<h;++i){a+=iD.w*.5;e*=-.75;vec3 g=f(a+sin(a.yx*.5+iD.w*.5)*.5);b+=g*d;a+=g.yz*.43;a*=2.;c+=d;d*=.75;}return b/c;}vec3 V(vec3 a,float c,vec3 d){float e=min(c/500.,1.),f=b(pow(e,3.5)+1.-exp(-c*.005)),g=max(dot(d,iS.xyz),0.);vec3 h=mix(vec3(.4,.8,1),vec3(1.065,.95,.85),pow(g,10.));return mix(a,h,f);}vec3 W(vec3 a,vec3 c){vec4 d=texelFetch(tP,ivec2(FC*256./iR),0);float e=uintBitsToFloat(uint(d.x*255.)<<24|uint(d.y*255.)<<16|uint(d.z*255.)<<8|uint(d.z*255.)),f=R(a,c,.001,e),h=T(a,c);vec3 i,j=vec3(0,1,0);float k=f;if(N==3)return iB.y>0.?texture(tS,J).xyz:vec3(0);vec3 l=a+c*f;bool m=h<500.&&h<f;vec3 n;float o=0.;if(m){o=mix(.2,1.,b((f-h)/3.));vec3 d=a+c*h,e=mix(vec3(0),U(d.xz*(.7-iS.w*.02))*(1.-length(d)/450.),o);j=normalize(vec3(e.y,1.,e.x));h-=abs(e.z)*o*.6;k=h;n=mix(vec3(.25,.52,.73),vec3(.15,.62,.83),b(abs(e.z)-o));}int p=N,q=g;if(N==0)i=vec3(.4,.8,1);else{vec3 a;if(l.y<=-2.9995){a=vec3(0,1,0);i=vec3(1);}else{i=vec3(.8);switch(p){case 1:a=Q(l,f);i=mix(vec3(.93,.8,.64),mix(vec3(.69+texture(tN,l.xz*1e-4).x,.67,.65),vec3(.38,.52,.23),dot(a,vec3(0,1,0))),b(l.y*.5-1.))+texture(tN,l.xz*.15).x*.1+texture(tN,l.xz*.01).y*.1;break;case 2:a=P(l);switch(q){case 1:i=vec3(1);break;case 2:i=vec3(1,0,0);break;case 3:i=vec3(.5,0,0);break;case 4:i=vec3(.2,.1,.2);break;case 5:i=vec3(1,.95,.8);break;case-1:i=vec3(.64000005,.48000002,.32000002);break;default:vec4 b=texture(tN,l.xy*.35)*a.z+texture(tN,l.yz*.35)*a.x+texture(tN,l.xz*.35)*a.y-.5;i+=.125*(b.x-b.y+b.z-b.w);break;}}j=normalize(mix(a,j,o));}}float r=m||p==2&&q>0?pow(b(dot(iS.xyz,reflect(c,j))),50.):0.,s=b(dot(iS.xyz,j)),t=b(dot(iS.xyz*vec3(-1,1,-1),j)),u=s+t*.15;if(p==1)u=pow(u*mix(.9,1.02,s*s),1.+s*.6);u=mix(u,s,o);float v=1.;if(N!=0)v=S(a+c*k,k,j,1.);if((iF&1)!=0&&f<20.){float a=pow(clamp(dot(iD.xyz,c),0.,1.),32.)*smoothstep(10.,0.,f);u+=a*max(dot(j,-c),0.)*(1.-u);v+=a*(1.-v);}i=mix(i,n,o);i=(i*vec3(1.065,.95,.85)*u+r)*mix(.38+(1.-u)*.2,1.,v);return V(i,k,c);}void main_c(){vec3 a=vec3(0,0,1);a.xz*=s(FC.x*.049087387+3.1415927);oC=d(.2-O(vec3(iP.x,iP.y+(FC.y/64.-1.)-.8,iP.z)+normalize(a)*.15));}void main_p(){vec2 b=FC/128.-1.+.001953125;vec3 c=normalize(iM*vec3(b.x*-1.5,b.y,2.4142134));float d=R(iP,c,.0046875,.15);uint e=floatBitsToUint(d>=150.?150.:d-a);oC=vec4(float(e>>24&255u)/255.,float(e>>16&255u)/255.,float(e>>8&255u)/255.,float(e&255u)/255.);}void main_m(){vec2 a=FC/(iR*.5)-1.;vec3 b=normalize(iM*vec3(a.x*-1.5,a.y,2.4142134));oC=vec4(W(iP,b),1);}float X(vec2 a,float c,float d,float e,float f){vec2 g=a-vec2(c,d);return b(1.-smoothstep(e-e*f,e,dot(g,g)*4.));}void main_h(){vec2 a=FC/(iR*.5)-1.,e=vec2(1.3,1),g=vec2(0);float h=0.,i=1.,j=1.,k=0.,l=1.;while(l<11.){vec3 b=f(21.1+a*e*s(l++*2.4));g+=b.yz;h+=j*(1.-b.x)/(1.+dot(g,g));i+=j*(.5-b.x);k+=j;j*=.5;e*=1.8;}h/=k;i*=.5;float m=length(a*(1.2-i+h))*b(i+.55-.5*h*a.x*(1.-a.y*.5)),n=X(a,-.45,-.52,1.,2.3)+X(a,-.6,-.1,1.,3.3)+X(a,.6,-.7,1.,5.)+X(a,.84,.84,h,i*5.);m=b(1.-c(m,1.-mix(0.,h*2.,n),.05+i*.5));vec2 o=1.-abs(a)+h*.04;m=c(m,c(o.x,o.y,.3)*2.,.1);oC=d(c(h,m,.01)*1.33-.045);}".replace("main_"+e,"main")),Ue.linkProgram(a),Ue.useProgram(a);const o=Ue.getUniformLocation(a,"tN"),c=Ue.getUniformLocation(a,"tH"),n=Ue.getUniformLocation(a,"tP"),i=Ue.getUniformLocation(a,"tS"),r=Ue.getUniformLocation(a,"iR"),f=Ue.getUniformLocation(a,"iM"),s=Ue.getUniformLocation(a,"iS"),b=Ue.getUniformLocation(a,"iP"),u=Ue.getUniformLocation(a,"iD"),x=Ue.getUniformLocation(a,"iF"),_=Ue.getUniformLocation(a,"iA"),d=Ue.getUniformLocation(a,"iB"),y=Ue.getUniformLocation(a,"iX");return[o,c,n,i].map((e,a)=>Ue.uniform1i(e,a)),(e,t,o)=>{Ue.viewport(0,0,e,t),Ue.useProgram(a),Ue.uniform2f(r,e,t);const c=.2*m(2*H+3);q(N(F,.4+.1*l(.02*H),.44+.1*m(.02*H)-.05,-.38)),Ue.uniform4f(s,F.x,F.y,F.z,c),Ue.uniform3f(b,oe.x,oe.y+(o?0:ce),oe.z),Ue.uniform4f(u,ie.x,ie.y,ie.z,H),Ue.uniformMatrix3fv(f,!1,le),Ue.uniform1i(x,(Z.j.T&&1)|(Z.L.P&&2)|(Z.j.P&&4)|(Z.I.P&&8)|(Z.ie.P&&16)),Ue.uniform4f(_,ee.ne.t,ee.X.t,ee.J.t,ee.V.t),Ue.uniform4f(d,ee.ce.t,ee.ee.t,ee.re.t,v(0,ee.ve.t)+c),Ue.uniform4f(y,6-6*ee.oe.t,0,0,0)}};let Qe,Ve,Ye;const Ze=Ue.createTexture(),$e=Ue.createTexture(),ea=Ue.createTexture(),aa=Ue.createFramebuffer(),ta=new t(65536),oa=(e,a)=>{const t=512*a+4*e;return ta[t]/255+ta[t+1]/65025+ta[t+2]/16581375+ta[t+3]/40948250625},ca=e=>-u*(e-64)/64-u/2,na=[Ue.createTexture(),Ue.createTexture(),Ue.createTexture(),Ue.createTexture()];let ia=-1;const la=e=>{const a=na[e];return ia!==e&&(ia=e,Ue.activeTexture(33987),Ue.bindTexture(3553,a)),a},ra=e.createElement("canvas");ra.width=512,ra.height=512;const fa=ra.getContext("2d"),va=e=>{la(e);const a=fa.getImageData(0,0,512,512);Ue.texImage2D(3553,0,6408,512,512,0,6408,5121,a),Je(33071)},sa=(e,a)=>{fa.beginPath();for(let t=-5;517>t;t++){const o=25*(m(.05*t)+m(t*e/3e3+a*x/360))+100;-4>t?fa.moveTo(t,o):fa.lineTo(t,o)}fa.stroke()},ma=()=>{fa.fillStyle="#000015",fa.fillRect(0,0,512,512),fa.strokeStyle="#f00",sa(70,300),fa.globalCompositeOperation="lighter",fa.strokeStyle="#0ff",sa(Q.k,Q.g),fa.globalCompositeOperation="source-over",fa.fillStyle="#ff0",fa.fillText("Satellite Frequency Alignment",10,20),fa.fillText("Frequency",7,260),fa.fillText("Phase",280,380),fa.strokeStyle="#0a0",fa.strokeRect(130,170,370,180),fa.beginPath(),fa.arc(135+Q.g,175+Q.k,8,0,x),fa.fill(),4>Q.h||(fa.fillStyle="#000015",fa.fillRect(0,160,512,512),fa.strokeRect(20,180,472,120),fa.fillStyle="#ff0",fa.fillText("\u{1f6f0}\ufe0f Satellite Frequency Found",80,230),fa.fillText("Autonomous Submarine Activated",75,260)),va(3)},ba=(e,a)=>{3===Q.h&&(Q.k=d(Q.k+e,0,170),Q.g=d(Q.g+a,0,360),70===Q.k&&300===Q.g&&(Q.h=4,Z.ve.P=!0,c(ee.ve)),ma())};w[1]=()=>ba(-5,0),w[2]=()=>ba(5,0),w[3]=()=>ba(0,-5),w[4]=()=>ba(0,5);const ua=Ue.createTexture(),xa=[Z,Y,ee,Q,oe,ne],_a=()=>localStorage.getItem("ISLAND_NOT_FOUND");Me.onclick=()=>{Xe&&(localStorage.setItem("ISLAND_NOT_FOUND",JSON.stringify(xa)),V("Saved",2),Ke(!1),Oe.className="")},Oe.onclick=()=>{const e=_a();e&&(G.length=0,J=W,De.innerHTML="",Ke(!1),n(xa,JSON.parse(e)),V("Game loaded",2),ma())},Oe.className=_a()?"":"X",setTimeout(()=>{(()=>{Ue.activeTexture(33984),Ue.bindTexture(3553,$e);const e=new t(1048576);let a=345,c=1082,n=254265,o=737;for(let t=0;512>t;++t){const i=2048*t,l=((t-1)%512+512)%512*2048;for(let t=0;512>t;++t){const r=o<<9;let f=5*a;f=9*(f<<7|f>>>25),c^=a,n^=o,o^=c,a^=n,c^=r,n=n<<11|n>>>21,f&=255;const v=4*t,s=((t-1)%512+512)%512*4;e[v+i]=f,e[s+i+1]=f,e[v+l+2]=f,e[s+l+3]=f}}Ue.texImage2D(3553,0,6408,512,512,0,6408,5121,e),Ue.hint(33170,4354),Ue.generateMipmap(3553),Je(10497,9987,9729)})(),Ue.activeTexture(33985),Ue.bindTexture(3553,Ze),Ue.texImage2D(3553,0,6408,4096,4096,0,6408,5121,null),Ue.bindFramebuffer(36160,We),Ue.framebufferTexture2D(36160,36064,3553,Ze,0),Ge("h")(4096,4096),Ue.drawArrays(4,0,3),Ue.generateMipmap(3553),Je(33071,9987,9729),Ue.bindFramebuffer(36160,null),fa.lineWidth=5,fa.scale(1,1.3),fa.fillStyle="#000015",fa.fillRect(0,0,512,512),fa.font="17px monospace",fa.fillStyle="#aee",fa.fillText("Memory Core: 132020K",10,100),fa.fillText("Launching xx142-b2.exe",10,124),fa.fillText("Antenna self test",10,146),fa.fillText("Activating radio",10,170),fa.fillStyle="#8f8",fa.fillText("OK",245,100),fa.fillText("OK",245,124),fa.fillText("OK",245,146),fa.fillStyle="#f66",fa.fillText("FAIL",245,170),fa.fillText("Insert floppy disk and press E to continue",42,280),fa.font="20px monospace",fa.fillText("\u{1f4be} ERROR 404 - data disk not found",48,250),fa.fillStyle="#4f8aff",fa.fillText("\u2b23 JS13K Modular Bios v.13",10,30),va(0),fa.strokeStyle="#f00",fa.strokeRect(20,220,472,80),va(1),fa.strokeStyle="#bb0",fa.fillStyle="#000",fa.fillRect(20,220,472,80),fa.strokeRect(20,220,472,80),fa.fillStyle="#bb0",fa.fillText("Loading data disk...",150,265),va(2),ma(),Ue.activeTexture(33986),Ue.bindTexture(3553,ua),Ue.texImage2D(3553,0,6408,256,256,0,6408,5121,null),Je(33071,9728),Ue.bindFramebuffer(36160,We),Ue.framebufferTexture2D(36160,36064,3553,ua,0),Ue.bindFramebuffer(36160,null),Ue.activeTexture(33989),Ue.bindTexture(3553,ea),Ue.texImage2D(3553,0,6408,128,128,0,6408,5121,null),Ue.bindFramebuffer(36160,aa),Ue.framebufferTexture2D(36160,36064,3553,ea,0),Ve=Ge("m"),Qe=Ge("c"),Ye=Ge("p"),(()=>{for(de=me.ye,ye=0,he=me._e*me.de*(de+1)*2,ze=new a(he);1>pe(););const e=(()=>{const e=44+2*he-8,a=e-36,o=new t(44+2*he);o.set([82,73,70,70,255&e,255&e>>8,255&e>>16,255&e>>24,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&a,255&a>>8,255&a>>16,255&a>>24]);for(let t,a=44,e=0;he>e;++e)t=ze[e],t=-32767>t?-32767:t>32767?32767:t,o[a++]=255&t,o[a++]=255&t>>8;return o})();ke.loop=!0,ke.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),ke.volume=.5})(),Te();const e=a=>{o(e),((e,a)=>{const t=e/1e3,o=t-K;return K=t,a?(X=0,t-U>=.2&&(U=t,!0)):(X=v(o,.033),H+=X,X>0)})(a,Se)&&((()=>{const e=(A[5]?5.5:2.1)*X;2===Q.h||3===Q.h||4===Q.h||Z.ve.se||(N(F,0,0,0),A[1]&&re(1),A[2]&&re(-1),A[3]&&fe(-1),A[4]&&fe(1),(F.x||F.z)&&(se+=X,ce=je?.03*m(10*se):0,M(oe,O(q(F),e)))),ve()})(),Se||(Z.ve.se||(()=>{Qe(128,128,!0),Ue.bindFramebuffer(36160,aa),Ue.drawArrays(4,0,3),Ue.readPixels(0,0,128,128,6408,5121,ta),Ue.bindFramebuffer(36160,null);let e=0;for(let t,a=0;128>a;a++){t=-99;for(let e=0;32>e;e++)t=f(oa(a,e),t);e+=t}const a=e/128-.2;let o=0,t=0;for(let e=32;96>e;++e)for(let a=0;64>a;++a){const c=a+64,n=oa(a,e),r=oa(c,e),f=ca(a),v=ca(c),s=l(f)*n+l(v)*r,b=m(f)*n+m(v)*r;i(s)>i(t)&&(t=s),i(b)>i(o)&&(o=b)}oe.x+=t,oe.y=f(oe.y+a,.9),oe.z+=o;const c=E(oe);100>c||(oe.x*=100/c,oe.z*=100/c)})(),(()=>{te=!1;for(const e of ae)e.v&&(e.ue&&(te=e.ue(e.t)),e.t+=e.me*X*e.v,(e.t>e.l||e.o>e.t)&&(e.t=e.v>0?e.l:e.o,e.be&&e.be(),e.v=0))})(),(()=>{const e=(()=>{for(const e of $)if(e.P){const a=e.N;if(b((({x,y,z},o)=>(o.x-x)**2+(o.y-y)**2+(o.z-z)**2)(a,oe))<=e.R&&B(ie,q(P(F,a,oe,h)))>.9)return e}})();V(e&&e.O()||""),e&&A[6]&&e.B()})(),J&&J._>0&&(J._-=X),0>J._&&G[0]&&(J=G.pop(),De.innerHTML=J.u)),Ye(256,256),Ue.bindFramebuffer(36160,We),Ue.drawArrays(4,0,3),Ue.bindFramebuffer(36160,null),la(v(Q.h||1&H,3)),Ve(Le,Ie),Ue.drawArrays(4,0,3))};o(e)},99)}()})(this)</script></body></html>